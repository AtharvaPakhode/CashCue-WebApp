<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org" th:replace="~{base-page-user-access::layout(~{::section})}">
<head>
    <meta charset="UTF-8">
    <title>Title</title>



</head>
<body>

<section class="bg-gray-50 text-gray-800">
<div class="flex  dynamic-content min-h-screen">


  <!-- Main Content -->
  <div class="flex-1 p-6">




    <!-- Recent Transactions -->
    <div class="mt-6" >

      <div class="flex justify-between items-center">
        <h2 class="text-xl font-bold animate-slide-fade-in">Recent Transactions</h2>

        <button
                id="filterTransactions"
                class="text-grey-50 mr-10 px-4 py-2 rounded animate-fade-in-slow group relative w-56 h-10 flex items-center justify-center overflow-hidden"
        >
          <!-- Text span -->
          <span class="absolute left-0 w-full text-center text-grey-50 font-semibold transform transition-all duration-300 group-hover:-translate-x-full">
    Filter Transactions
  </span>

          <!-- Icon span -->
          <span class="absolute left-full w-full flex items-center justify-center text-grey-50 transform transition-all duration-300 group-hover:-translate-x-full">
    <svg
            class="w-6 h-6"
            fill="none"
            stroke="currentColor"
            stroke-linecap="round"
            stroke-linejoin="round"
            stroke-width="2"
            viewBox="0 0 24 24"
            xmlns="http://www.w3.org/2000/svg"
    >
      <!-- Filter icon -->
      <line x1="4" y1="21" x2="4" y2="14" />
      <line x1="4" y1="10" x2="4" y2="3" />
      <line x1="12" y1="21" x2="12" y2="12" />
      <line x1="12" y1="8" x2="12" y2="3" />
      <line x1="20" y1="21" x2="20" y2="16" />
      <line x1="20" y1="12" x2="20" y2="3" />
      <line x1="1" y1="14" x2="7" y2="14" />
      <line x1="9" y1="8" x2="15" y2="8" />
      <line x1="17" y1="16" x2="23" y2="16" />
    </svg>
  </span>
        </button>



      </div>




      <form class="space-y-6 mt-3" id="filterForm" th:object="${userCategories}" th:action="@{/user/expense-history/0}" method="get">



        <label class="block text-lg font-semibold mb-2">
          Category
        </label>

        <div class="max-h-40 overflow-y-auto space-y-2 pr-1 custom-scroll scroll-smooth">
          <div th:each="category : ${userCategories}" class="checkbox-wrapper-46">
            <input type="checkbox"
                   th:id="'cbx-46-' + ${category.categoryName}"
                   class="inp-cbx"
                   th:name="categories"
                   th:value="${category.categoryName}" />

            <label th:for="'cbx-46-' + ${category.categoryName}" class="cbx">
      <span>
        <svg viewBox="0 0 12 10" height="10px" width="12px">
          <polyline points="1.5 6 4.5 9 10.5 1"></polyline>
        </svg>
      </span>
              <span th:text="${category.categoryName}">Category Name</span>
            </label>
          </div>
        </div>




        <div>
          <label class="block text-lg font-semibold mb-2">
            Payment Method
          </label>
          <select  name="paymentMethod" class="w-full p-2 border border-gray-300 rounded bg-gray-50">
            <option value="">Select payment method</option> <!-- Sends null to backend -->
            <option value="CASH">Cash</option>
            <option value="UPI">UPI</option>
            <option value="NET_BANKING">Net Banking</option>
            <option value="CREDIT_CARD">Credit Card</option>
            <option value="DEBIT_CARD">Debit Card</option>
          </select>
        </div>


        <div>
          <label class="block text-lg font-semibold mb-2">
            Amount Range
          </label>
          <div class="flex space-x-4">
            <div class="flex-1">
              <label class="block text-sm mb-1">
                Minimum Amount
              </label>
              <div class="flex items-center">
                <input  name="minAmount" class="w-full p-2 border border-gray-300 rounded bg-gray-50" type="number"/>
              </div>
            </div>
            <div class="flex-1">
              <label class="block text-sm mb-1">
                Maximum Amount
              </label>
              <div class="flex items-center">
                <input name="maxAmount" class="w-full p-2 border border-gray-300 rounded bg-gray-50" type="number"/>
              </div>
            </div>
          </div>
        </div>


        <div>
          <label class="block text-lg font-semibold mb-2">
            Date Range
          </label>
          <div class="flex space-x-4">
            <div class="flex-1">
              <label class="block text-sm mb-1">
                Start Date
              </label>
              <div class="flex items-center">
                <input  name="startDate" class="w-full p-2 border border-gray-300 rounded bg-gray-50" placeholder="MM/DD/YYYY" type="date"/>

              </div>
            </div>
            <div class="flex-1">
              <label class="block text-sm mb-1">
                End Date
              </label>
              <div class="flex items-center">
                <input  name="endDate" class="w-full p-2 border border-gray-300 rounded bg-gray-50" placeholder="MM/DD/YYYY" type="date"/>

              </div>
            </div>
          </div>
        </div>


        <div class="flex space-x-4">
          <button
                  id="applyFilters"
                  type="submit"
                  class="text-grey-50 px-4 py-2 rounded group relative w-56 h-10 flex items-center justify-center overflow-hidden"
          >
            <!-- Text -->
            <span class=" text-grey-50 absolute left-0 w-full text-center  font-semibold transform transition-all duration-300 group-hover:translate-x-full">
    Apply Filters
  </span>

            <!-- Icon -->
            <span class="absolute -left-full w-full flex items-center justify-center text-grey-50 transform transition-all duration-300 group-hover:translate-x-full">
    <svg
            class="w-6 h-6"
            fill="none"
            stroke="currentColor"
            stroke-linecap="round"
            stroke-linejoin="round"
            stroke-width="2"
            viewBox="0 0 24 24"
            xmlns="http://www.w3.org/2000/svg"
    >
      <!-- Check Circle Icon -->
      <path d="M9 12l2 2 4-4" />
      <circle cx="12" cy="12" r="10" />
    </svg>
  </span>
          </button>

          <button class="border border-gray-300 text-gray-700 px-4 py-2 rounded" type="reset">
            Reset
          </button>
        </div>


      </form>


      <div class="mt-5 animate-fade-in-slow" th:if="${userTransactions != null}">
        <div th:each="transaction : ${userTransactions}" class="bg-white p-4 rounded-2xl shadow-md hover:shadow-lg transition mb-3 border-1 border-[#1f2937] flex justify-between items-center">

          <!-- Left: Title and Date -->
          <div>
            <p class="text-xl font-semibold text-gray-800" th:text="${transaction.name}">Expense Title</p>
            <p class="text-sm text-gray-500" th:text="${#temporals.format(transaction.localDateTime, 'MMMM dd, yyyy')}">Expense Date</p>
          </div>

          <!-- Right: Category and Amount -->
          <div class="text-right">
            <p class="text-sm text-gray-500" th:text="${transaction.category.categoryName}">Category</p>
            <p class="text-lg font-bold text-red-600" th:text="'₹' + ${transaction.amount}">-₹0.00</p>
          </div>

        </div>
      </div>



      <nav class="mt-6 flex justify-center animate-fade-in-slow" th:if="${totalPages > 0}">
        <ul class="flex space-x-1">

          <!-- Previous Page -->
          <li th:if="${currentPage > 0}">
            <a th:href="@{/user/expense-history/{page}(page=${currentPage - 1},
                categories=${filterCategories},
                minAmount=${minAmount},
                maxAmount=${maxAmount},
                paymentMethod=${paymentMethod},
                startDate=${startDate},
                endDate=${endDate})}"
               class="page-link px-3 py-1 rounded"
               style="background-color:#1f2937; color:white">
              &laquo;
            </a>
          </li>

          <!-- Page Numbers -->
          <li th:each="i : ${#numbers.sequence(0, totalPages - 1)}">
            <a th:href="@{/user/expense-history/{page}(page=${i},
                categories=${filterCategories},
                minAmount=${minAmount},
                maxAmount=${maxAmount},
                paymentMethod=${paymentMethod},
                startDate=${startDate},
                endDate=${endDate})}"
               th:classappend="${i == currentPage} ? 'ring-2 ring-offset-1 ring-teal-400 font-semibold' : ''"
               class="page-link px-3 py-1 rounded"
               style="background-color:#1f2937; color:white">
              <span th:text="${i + 1}"></span>
            </a>
          </li>

          <!-- Next Page -->
          <li th:if="${currentPage + 1 < totalPages}">
            <a th:href="@{/user/expense-history/{page}(page=${currentPage + 1},
                categories=${filterCategories},
                minAmount=${minAmount},
                maxAmount=${maxAmount},
                paymentMethod=${paymentMethod},
                startDate=${startDate},
                endDate=${endDate})}"
               class="page-link px-3 py-1 rounded"
               style="background-color:#1f2937; color:white">
              &raquo;
            </a>
          </li>

        </ul>
      </nav>



      <div th:if="${totalPages == 0}" class="text-center text-gray-500 animate-fade-in-slow">
        No Transactions found
      </div>


    </div>
  </div>
</div>
</section>

<div th:fragment="scripts">
  <script src="https://cdn.tailwindcss.com"></script>
  <script type="text/javascript" th:src="@{/javascript/expense-history-script.js}"  ></script>
</div>

</body>

</html>