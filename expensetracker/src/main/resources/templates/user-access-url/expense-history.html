<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org" th:replace="~{base-page-user-access::layout(~{::section})}">
<head>
    <meta charset="UTF-8">
    <title>Title</title>

  <div th:replace="~{base-page-user-access :: styles-expense-hostory}" />

</head>
<body>

<section class="bg-gray-50 text-gray-800">
<div class="flex  dynamic-content min-h-screen">


  <!-- Main Content -->
  <div class="flex-1 p-6">




    <!-- Recent Transactions -->
    <div class="mt-6" >

      <div class="flex justify-between items-center">
        <h2 class="text-xl font-bold">Recent Transactions</h2>

        <button class=" text-black px-4 py-2 rounded " id="filterTransactions">
          Filter Transactions
        </button>

      </div>




      <form class="space-y-6 mt-3" id="filterForm" th:object="${userCategories}">

        <label class="block text-lg font-semibold mb-2">
          Category
        </label>

        <div class="max-h-20 overflow-y-auto space-y-2 pr-1 custom-scroll">
          <div th:each="category : ${userCategories}" class="checkbox-wrapper-46">
            <input type="checkbox"
                   th:id="'cbx-46-' + ${category.categoryName}"
                   class="inp-cbx"
                   th:name="categories"
                   th:value="${category.categoryName}" />

            <label th:for="'cbx-46-' + ${category.categoryName}" class="cbx">
      <span>
        <svg viewBox="0 0 12 10" height="10px" width="12px">
          <polyline points="1.5 6 4.5 9 10.5 1"></polyline>
        </svg>
      </span>
              <span th:text="${category.categoryName}">Category Name</span>
            </label>
          </div>
        </div>




        <div>
          <label class="block text-lg font-semibold mb-2">
            Payment Method
          </label>
          <select class="w-full p-2 border border-gray-300 rounded bg-gray-50">
            <option value="">Select payment method</option> <!-- Sends null to backend -->
            <option value="CASH">Cash</option>
            <option value="UPI">UPI</option>
            <option value="NET_BANKING">Net Banking</option>
            <option value="CREDIT_CARD">Credit Card</option>
            <option value="DEBIT_CARD">Debit Card</option>
          </select>
        </div>


        <div>
          <label class="block text-lg font-semibold mb-2">
            Amount Range
          </label>
          <div class="flex space-x-4">
            <div class="flex-1">
              <label class="block text-sm mb-1">
                Minimum Amount
              </label>
              <div class="flex items-center">
                <input class="w-full p-2 border border-gray-300 rounded bg-gray-50" type="number"/>
              </div>
            </div>
            <div class="flex-1">
              <label class="block text-sm mb-1">
                Maximum Amount
              </label>
              <div class="flex items-center">
                <input class="w-full p-2 border border-gray-300 rounded bg-gray-50" type="number"/>
              </div>
            </div>
          </div>
        </div>


        <div>
          <label class="block text-lg font-semibold mb-2">
            Date Range
          </label>
          <div class="flex space-x-4">
            <div class="flex-1">
              <label class="block text-sm mb-1">
                Start Date
              </label>
              <div class="flex items-center">
                <input class="w-full p-2 border border-gray-300 rounded bg-gray-50" placeholder="MM/DD/YYYY" type="date"/>

              </div>
            </div>
            <div class="flex-1">
              <label class="block text-sm mb-1">
                End Date
              </label>
              <div class="flex items-center">
                <input class="w-full p-2 border border-gray-300 rounded bg-gray-50" placeholder="MM/DD/YYYY" type="date"/>

              </div>
            </div>
          </div>
        </div>


        <div class="flex space-x-4">
          <button class="text-black px-4 py-2 rounded" type="submit" id="applyFilters">
            Apply Filters
          </button>
          <button class="border border-gray-300 text-gray-700 px-4 py-2 rounded" type="reset">
            Reset
          </button>
        </div>


      </form>


      <div class="mt-3" th:if="${userTransactions != null}">
        <div class="space-y-4" th:each="transaction : ${userTransactions}">

          <!-- Each transaction box -->
          <div class="bg-white p-4 rounded-lg shadow flex justify-between items-center mt-2">

            <!-- Left: Title and Date -->
            <div class="flex items-center space-x-4">
              <div>
                <p class="text-gray-800 font-bold" th:text="${transaction.name}">Expense Title</p>
                <p class="text-gray-500" th:text="${#temporals.format(transaction.date, 'MMMM d, yyyy')}">Expense Date</p>
              </div>
            </div>

            <!-- Right: Category and Amount -->
            <div class="flex items-center space-x-4">
              <p class="text-gray-500" th:text="${transaction.category.categoryName}">Category Name</p>
              <p th:text="${transaction.amount}">-$0.00</p>
            </div>

          </div>

        </div>
      </div>


      <!-- Pagination Section -->
      <nav class="mt-6 flex justify-center" th:if="${totalPages > 0}">
        <ul class="flex space-x-2">
          <!-- Previous Page -->
          <li th:if="${currentPage > 0}">
            <a th:href="@{/user/expense-history/{page}(page=${currentPage - 1})}"
               style="background-color:#c2edda;color:black"
               class="page-link"
               aria-label="Previous">&laquo;</a>
          </li>

          <!-- Page Numbers -->
          <!-- Page Number Links -->
          <li th:classappend="${currentPage == i ? 'active' : ''}" th:each="i : ${#numbers.sequence(0, totalPages - 1)}" class="page-item">
            <a class="page-link" th:href="@{/user/expense-history/{page}(page=${i})}"
               style="background-color: #c2edda; color:black">
              <span th:text="${i + 1}"></span> <!-- Display page number starting from 1 -->
            </a>
          </li>

          <!-- Next Page -->
          <li th:if="${currentPage + 1 < totalPages}">
            <a th:href="@{/user/expense-history/{page}(page=${currentPage + 1})}"
               style="background-color:#c2edda;color:black"
               class="page-link"
               aria-label="Next">&raquo;</a>
          </li>
        </ul>
      </nav>


      <!-- No Categories Found Message -->
      <div th:if="${totalPages == 0}" class="text-center text-gray-500">
        No Transactions found
      </div>




      <!-- Spending by Category -->
    <div class="mt-10">

      <div class="flex justify-between items-center">
        <h2 class="text-xl font-bold">Spending by Category</h2>
        <a href="#" class="text-purple-600">View Report</a>
      </div>

      <label for="monthSelect" class="block text-black font-semibold ml-3 mt-4 mb-2">Select Month</label>
      <select id="monthSelect" name="month" class="w-full p-3 border border-gray-300 rounded-xl bg-gray-100">
        <option value="01">January</option>
        <option value="02">February</option>
        <option value="03">March</option>
        <option value="04">April</option>
        <option value="05">May</option>
        <option value="06">June</option>
        <option value="07">July</option>
        <option value="08">August</option>
        <option value="09">September</option>
        <option value="10">October</option>
        <option value="11">November</option>
        <option value="12">December</option>
      </select>


      <div class="bg-white mt-4 p-4 rounded-lg shadow">

        <div class="mt-3 space-y-4">
          <div class="flex justify-between items-center">
            <div class="flex items-center space-x-4">

              <div>
                <p class="text-gray-800">Food & Dining</p>
                <p class="text-gray-500">$485.25 (26%)</p>
              </div>
            </div>
            <i class="fas fa-chevron-right text-gray-600"></i>
          </div>
        </div>

      </div>
      </div>
    </div>
  </div>
</div>
</section>

<div th:fragment="scripts">
  <script src="https://cdn.tailwindcss.com"></script>
  <script type="text/javascript" th:src="@{/javascript/expense-history-script.js}"  ></script>
</div>

</body>

</html>