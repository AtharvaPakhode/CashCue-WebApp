<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org" th:replace="~{base-page-user-access::layout(~{::section})}">
<head>
    <meta charset="utf-8" />
    <title>
        Add New Expense
    </title>



</head>

<body>
<section>
    <div class="flex dynamic-content" >
        <!-- Main Content -->
        <div class="flex-1 p-8">
            <div class="mb-4">
                <h1 class="text-4xl font-bold mb-6">
                    Add New Expense
                </h1>

            <form class="space-y-6" th:action="@{/user/add-expense-process}" method="post" th:object="${expense}">


                <div>
                    <label class="block text-black font-semibold ml-3 mb-2">
                        Expense Title
                    </label>
                    <input  th:classappend="${#fields.hasErrors('name') ? 'border-red-500 bg-red-100' : ''}"
                            class="w-full p-3 border border-gray-300 rounded-xl bg-gray-100"
                           placeholder="Enter a short description" name="name" id="expenseTitle" type="text" />
                    <div th:if="${#fields.hasErrors('name')}" class="text-red-500 text-sm mt-1">
                        <p th:each="e : ${#fields.errors('name')}" th:text="${e}"></p>
                    </div>
                </div>


                <div class="flex items-center space-x-4">
                    <div class="flex-1">
                        <label class="block text-black font-semibold ml-3 mb-2">
                            Amount
                        </label>
                        <input  th:classappend="${#fields.hasErrors('amount') ? 'border-red-500 bg-red-100' : ''}"

                                class="w-full p-3 border border-gray-300 rounded-xl bg-gray-100"
                                placeholder="Enter the amount" name="amount" id="amount" type="number" required />
                        <div th:if="${#fields.hasErrors('amount')}" class="text-red-500 text-sm mt-1">
                            <p th:each="e : ${#fields.errors('amount')}" th:text="${e}"></p>
                        </div>

                    </div>
                </div>


                <div>
                    <label class="block text-black font-semibold ml-3 mb-2">
                        Category
                    </label>

                    <!-- categories == list passed from the controller to view by addattribute-->
                    <!-- category == iterator used to iterate over list-->
                    <select class="w-full p-3 border border-gray-300 rounded-xl bg-gray-100" name="category">
                        <!-- Check if categories are empty -->
                        <option th:if="${categories == null or categories.isEmpty()}" disabled>No categories added</option>

                        <!-- If categories exist, render options -->
                        <option th:if="${categories != null and not categories.isEmpty()}" value="" >Select a category</option>

                        <option th:each="category : ${categories}"   th:value="${category.categoryName}" th:text="${category.categoryName}"></option>
                    </select>

                    <div th:if="${#fields.hasErrors('category')}" class="text-red-500 text-sm mt-1">
                        <p th:each="e : ${#fields.errors('category')}" th:text="${e}"></p>
                    </div>

                </div>


                <div>
                    <div class="flex-1">
                        <label class="block text-black font-semibold ml-3 mb-2">
                            Date
                        </label>
                        <input class="w-full p-3 border border-gray-300 rounded-xl bg-gray-100"
                               placeholder="MM/DD/YYYY"  name="date" id="dateOfExpense" type="date" />
                    </div>

                    <div th:if="${#fields.hasErrors('date')}" class="text-red-500 text-sm mt-1">
                        <p th:each="e : ${#fields.errors('date')}" th:text="${e}"></p>
                    </div>
                </div>


                <div>
                    <label class="block text-black font-semibold ml-3 mb-2">
                        Payment Method
                    </label>
                    <select class="w-full p-3 border border-gray-300 rounded-xl bg-gray-100" name="paymentMethod">
                        <option value="">Select payment method</option> <!-- Sends null to backend -->
                        <option value="CASH">Cash</option>
                        <option value="UPI">UPI</option>
                        <option value="NET_BANKING">Net Banking</option>
                        <option value="CREDIT_CARD">Credit Card</option>
                        <option value="DEBIT_CARD">Debit Card</option>
                    </select>


                    <div th:if="${#fields.hasErrors('paymentMethod')}" class="text-red-500 text-sm mt-1">
                        <p th:each="e : ${#fields.errors('paymentMethod')}" th:text="${e}"></p>
                    </div>
                </div>


                <div>
                    <label class="block text-black font-semibold ml-3 mb-2">
                        Description (Optional)
                    </label>
                    <textarea id="description" class="w-full p-3 border border-gray-300 rounded-xl bg-gray-100 h-24"
                              placeholder="Add any additional details" name="description"></textarea>

                    <div th:if="${#fields.hasErrors('description')}" class="text-red-500 text-sm mt-1">
                        <p th:each="e : ${#fields.errors('description')}" th:text="${e}"></p>
                    </div>
                </div>



                <div class="flex justify-between items-center mt-6">
                    <button id="cancel-expense" class="px-6 py-3  text-black font-semibold rounded-md" type="reset"
                            style="background-color: #c2edda">
                        Cancel
                    </button>
                    <button id="save-expense" class="px-6 py-3 text-black font-semibold rounded-md" type="submit"
                            style="background-color: #c2edda">
                        Save Expense
                    </button>
                </div>

            </form>
            </div>
        </div>
    </div>
</section>

<div th:fragment="scripts">
    <script src="https://cdn.tailwindcss.com"></script>
    <script type="text/javascript" th:src="@{/javascript/add-expense-script.js}"  ></script>
</div>
</body>
</html>
